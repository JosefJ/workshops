

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Extending functionality with plugins &mdash; Embark 2.4.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Embark 2.4.0 documentation" href="index.html"/>
        <link rel="next" title="Using Embark with Grunt" href="using-embark-with-grunt.html"/>
        <link rel="prev" title="Deploying to SWARM" href="deploying-to-swarm.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Embark
          

          
          </a>

          
            
            
              <div class="version">
                2.4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html#usage-demo">Usage - Demo</a></li>
<li class="toctree-l1"><a class="reference internal" href="dashboard.html">Dashboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="creating-a-new-dapp.html">Creating a new DApp</a></li>
<li class="toctree-l1"><a class="reference internal" href="creating-a-new-dapp.html#dapp-structure">DApp Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="libraries-and-languages-available.html">Libraries and languages available</a></li>
<li class="toctree-l1"><a class="reference internal" href="using-contracts.html">Configuring &amp; Using Contracts</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuring-storage.html">Configuring Storage (IPFS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuring-communication.html">Configuring Communication (Whisper, Orbit)</a></li>
<li class="toctree-l1"><a class="reference internal" href="embarkjs.html">EmbarkJS</a></li>
<li class="toctree-l1"><a class="reference internal" href="embarkjs-storage.html">EmbarkJS - Storage (IPFS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="embarkjs-communication.html">EmbarkJS - Communication (Whisper, Orbit)</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests.html">Testing Ethereum Contracts</a></li>
<li class="toctree-l1"><a class="reference internal" href="working-with-different-chains.html">Working with different chains</a></li>
<li class="toctree-l1"><a class="reference internal" href="structuring-application.html">Structuring Application</a></li>
<li class="toctree-l1"><a class="reference internal" href="deploying-to-ipfs.html">Deploying to IPFS</a></li>
<li class="toctree-l1"><a class="reference internal" href="deploying-to-swarm.html">Deploying to SWARM</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Extending functionality with plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="using-embark-with-grunt.html">Using Embark with Grunt</a></li>
<li class="toctree-l1"><a class="reference internal" href="donations.html">Donations</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Embark</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Extending functionality with plugins</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/plugins.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="extending-functionality-with-plugins">
<h1>Extending functionality with plugins<a class="headerlink" href="#extending-functionality-with-plugins" title="Permalink to this headline">Â¶</a></h1>
<p><strong>To add a plugin to embark:</strong></p>
<ol class="arabic simple">
<li>Add the npm package to package.json
e.g <code class="docutils literal"><span class="pre">npm</span> <span class="pre">install</span> <span class="pre">embark-babel</span> <span class="pre">--save</span></code></li>
<li>Then add the package to <code class="docutils literal"><span class="pre">plugins:</span></code> in embark.json
e.g <code class="docutils literal"><span class="pre">&quot;plugins&quot;:</span> <span class="pre">{</span> <span class="pre">&quot;embark-babel&quot;:</span> <span class="pre">{}</span> <span class="pre">}</span></code></li>
</ol>
<p><strong>Creating a plugin:</strong></p>
<ol class="arabic simple">
<li><code class="docutils literal"><span class="pre">mkdir</span> <span class="pre">yourpluginname</span></code></li>
<li><code class="docutils literal"><span class="pre">cd</span> <span class="pre">yourpluginname</span></code></li>
<li><code class="docutils literal"><span class="pre">npm</span> <span class="pre">init</span></code></li>
<li>create and edit <code class="docutils literal"><span class="pre">index.js</span></code></li>
<li>add the following code:</li>
</ol>
<div class="code javascript highlight-default"><div class="highlight"><pre><span></span><span class="n">module</span><span class="o">.</span><span class="n">exports</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">embark</span><span class="p">)</span> <span class="p">{</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">embark</span></code> object then provides an api to extend different functionality of embark.</p>
<p><strong>Usecases examples</strong></p>
<ul class="simple">
<li>plugin to add support for es6, jsx, coffescript, etc (<code class="docutils literal"><span class="pre">embark.registerPipeline</span></code>)</li>
<li>plugin to add standard contracts or a contract framework (<code class="docutils literal"><span class="pre">embark.registerContractConfiguration</span></code> and <code class="docutils literal"><span class="pre">embark.addContractFile</span></code>)</li>
<li>plugin to make some contracts available in all environments for use by other contracts or the dapp itself e.g a Token, a DAO, ENS, etc.. (<code class="docutils literal"><span class="pre">embark.registerContractConfiguration</span></code> and <code class="docutils literal"><span class="pre">embark.addContractFile</span></code>)</li>
<li>plugin to add a libraries such as react or boostrap (<code class="docutils literal"><span class="pre">embark.addFileToPipeline</span></code>)</li>
<li>plugin to specify a particular web3 initialization for special provider uses (<code class="docutils literal"><span class="pre">embark.registerClientWeb3Provider</span></code>)</li>
<li>plugin to create a different contract wrapper (<code class="docutils literal"><span class="pre">embark.registerContractsGeneration</span></code>)</li>
<li>plugin to add new console commands (<code class="docutils literal"><span class="pre">embark.registerConsoleCommand</span></code>)</li>
<li>plugin to add support for another contract language such as viper, LLL, etc (<code class="docutils literal"><span class="pre">embark.registerCompiler</span></code>)</li>
<li>plugin that executes certain actions when contracts are deployed (<code class="docutils literal"><span class="pre">embark.events.on</span></code>)</li>
</ul>
<p><strong>embark.pluginConfig</strong></p>
<p>Object containing the config for the plugin specified in embark.json, for e.g with:</p>
<div class="code json highlight-default"><div class="highlight"><pre><span></span><span class="s2">&quot;plugins&quot;</span><span class="p">:</span> <span class="p">{</span>
  <span class="s2">&quot;embark-babel&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;files&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;**/*.js&quot;</span><span class="p">,</span> <span class="s2">&quot;!**/jquery.min.js&quot;</span><span class="p">],</span> <span class="s2">&quot;presets&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;es2015&quot;</span><span class="p">,</span> <span class="s2">&quot;react&quot;</span><span class="p">]</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">embark.pluginConfig</span></code> will contain <code class="docutils literal"><span class="pre">{</span> <span class="pre">&quot;files&quot;:</span> <span class="pre">[&quot;**/*.js&quot;,</span> <span class="pre">&quot;!**/jquery.min.js&quot;],</span> <span class="pre">&quot;presets&quot;:</span> <span class="pre">[&quot;es2015&quot;,</span> <span class="pre">&quot;react&quot;]</span> <span class="pre">}</span></code></p>
<p><strong>embark.registerPipeline(matchingFiles, callback(options))</strong></p>
<p>This call will return the content of the current asset file so the plugin can transform it in some way. Typically this is used to implement pipeline plugins such as Babel, JSX, sass to css, etc..</p>
<p><code class="docutils literal"><span class="pre">matchingFiles</span></code> is an array of matching files the plugin should be called for e.g [<code class="docutils literal"><span class="pre">**/*.js</span></code>, <code class="docutils literal"><span class="pre">!vendor/jquery.js</span></code>] matches all javascript files except vendor/jquery.js</p>
<dl class="docutils">
<dt>options available:</dt>
<dd><ul class="first last simple">
<li>targetFile - filename to be generated</li>
<li>source - content of the file</li>
</ul>
</dd>
</dl>
<p>expected return: <code class="docutils literal"><span class="pre">string</span></code></p>
<div class="code javascript highlight-default"><div class="highlight"><pre><span></span><span class="n">var</span> <span class="n">babel</span> <span class="o">=</span> <span class="n">require</span><span class="p">(</span><span class="s2">&quot;babel-core&quot;</span><span class="p">);</span>
<span class="n">require</span><span class="p">(</span><span class="s2">&quot;babel-preset-react&quot;</span><span class="p">);</span>

<span class="n">module</span><span class="o">.</span><span class="n">exports</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">embark</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">embark</span><span class="o">.</span><span class="n">registerPipeline</span><span class="p">([</span><span class="s2">&quot;**/*.js&quot;</span><span class="p">,</span> <span class="s2">&quot;**/*.jsx&quot;</span><span class="p">],</span> <span class="n">function</span><span class="p">(</span><span class="n">options</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="n">babel</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">source</span><span class="p">,</span> <span class="p">{</span><span class="n">minified</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span> <span class="n">presets</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;react&#39;</span><span class="p">]})</span><span class="o">.</span><span class="n">code</span><span class="p">;</span>
    <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>embark.registerContractConfiguration(contractsConfig)</strong></p>
<p>This call is used to specify a configure of one or more contracts in one or
several environments. This is useful for specifying the different configurations
a contract might have depending on the enviroment. For instance in the code
bellow, the <code class="docutils literal"><span class="pre">DGDToken</span></code> contract code will redeployed with the arguments
<code class="docutils literal"><span class="pre">100</span></code> in any environment, except for the livenet since it&#8217;s already deployed
there at a particular address.</p>
<p>Typically this call is used in combination with <code class="docutils literal"><span class="pre">embark.addContractFile</span></code></p>
<p><code class="docutils literal"><span class="pre">contractsConfig</span></code> is an object in the same structure as the one found in the
contracts configuration at <code class="docutils literal"><span class="pre">config/contracts.json</span></code>. The users own
configuration will be merged with the one specified in the plugins.</p>
<div class="code javascript highlight-default"><div class="highlight"><pre><span></span><span class="n">module</span><span class="o">.</span><span class="n">exports</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">embark</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">embark</span><span class="o">.</span><span class="n">registerContractConfiguration</span><span class="p">({</span>
      <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;contracts&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;DGDToken&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">[</span>
              <span class="mi">100</span>
            <span class="p">]</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">},</span>
      <span class="s2">&quot;livenet&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;contracts&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;DGDToken&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;0xe0b7927c4af23765cb51314a0e0521a9645f0e2a&quot;</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>embark.addContractFile(file)</strong></p>
<p>Typically this call is used in combination with <code class="docutils literal"><span class="pre">embark.registerContractConfiguration</span></code>. If you want to make the contract available but not automatically deployed without the user specifying so you can use <code class="docutils literal"><span class="pre">registerContractConfiguration</span></code> to set the contract config to <code class="docutils literal"><span class="pre">deploy:</span> <span class="pre">false</span></code>, this is particularly useful for when the user is meant to extend the contract being given (e.g <code class="docutils literal"><span class="pre">contract</span> <span class="pre">MyToken</span> <span class="pre">is</span> <span class="pre">StandardToken</span></code>)</p>
<p><code class="docutils literal"><span class="pre">file</span></code> is the contract file to add to embark, the path should relative to the plugin.</p>
<div class="code javascript highlight-default"><div class="highlight"><pre><span></span><span class="n">module</span><span class="o">.</span><span class="n">exports</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">embark</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">embark</span><span class="o">.</span><span class="n">addContractFile</span><span class="p">(</span><span class="s2">&quot;./DGDToken.sol&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>embark.addFileToPipeline(file, options)</strong></p>
<p>This call is used to add a file to the pipeline so it&#8217;s included with the dapp on the client side.</p>
<p><code class="docutils literal"><span class="pre">file</span></code> is the file to add to the pipeline, the path should relative to the plugin.</p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">options</span></code> available:</dt>
<dd><ul class="first last simple">
<li>skipPipeline - If true it will not apply transformations to the file. For
example if you have a babel plugin to transform es6 code or a minifier plugin, setting this to
true will not apply the plugin on this file.</li>
</ul>
</dd>
</dl>
<div class="code javascript highlight-default"><div class="highlight"><pre><span></span><span class="n">module</span><span class="o">.</span><span class="n">exports</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">embark</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">embark</span><span class="o">.</span><span class="n">addFileToPipeline</span><span class="p">(</span><span class="s2">&quot;./jquery.js&quot;</span><span class="p">,</span> <span class="p">{</span><span class="n">skipPipeline</span><span class="p">:</span> <span class="n">true</span><span class="p">});</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>embark.registerClientWeb3Provider(callback(options))</strong></p>
<p>This call can be used to override the default web3 object generation in the dapp. it&#8217;s useful if you want to add a plugin to interact with services like <a class="reference external" href="http://infura.io">http://infura.io</a> or if you want to use your own web3.js library extension.</p>
<dl class="docutils">
<dt>options available:</dt>
<dd><ul class="first last simple">
<li>rpcHost - configured rpc Host to connect to</li>
<li>rpcPort - configured rpc Port to connect to</li>
<li>blockchainConfig - object containing the full blockchain configuration for the current environment</li>
</ul>
</dd>
</dl>
<p>expected return: <code class="docutils literal"><span class="pre">string</span></code></p>
<p>example:</p>
<div class="code javascript highlight-default"><div class="highlight"><pre><span></span><span class="n">module</span><span class="o">.</span><span class="n">exports</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">embark</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">embark</span><span class="o">.</span><span class="n">registerClientWeb3Provider</span><span class="p">(</span><span class="n">function</span><span class="p">(</span><span class="n">options</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s2">&quot;web3 = new Web3(new Web3.providers.HttpProvider(&#39;http://&quot;</span> <span class="o">+</span> <span class="n">options</span><span class="o">.</span><span class="n">rpcHost</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">options</span><span class="o">.</span><span class="n">rpcPort</span> <span class="o">+</span> <span class="s2">&quot;&#39;);&quot;</span><span class="p">;</span>
    <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>embark.registerContractsGeneration(callback(options))</strong></p>
<p>By default Embark will use EmbarkJS to declare contracts in the dapp. You can override and use your own client side library.</p>
<dl class="docutils">
<dt>options available:</dt>
<dd><ul class="first simple">
<li>contracts - Hash of objects containing all the deployed contracts. (key: contractName, value: contract object)</li>
</ul>
<blockquote class="last">
<div><ul class="simple">
<li>abiDefinition</li>
<li>code</li>
<li>deployedAddress</li>
<li>gasEstimates</li>
<li>gas</li>
<li>gasPrice</li>
<li>runtimeByteCode</li>
</ul>
</div></blockquote>
</dd>
</dl>
<p>expected return: <code class="docutils literal"><span class="pre">string</span></code></p>
<div class="code javascript highlight-default"><div class="highlight"><pre><span></span><span class="n">module</span><span class="o">.</span><span class="n">exports</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">embark</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">embark</span><span class="o">.</span><span class="n">registerContractsGeneration</span><span class="p">(</span><span class="n">function</span><span class="p">(</span><span class="n">options</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">for</span><span class="p">(</span><span class="n">var</span> <span class="n">className</span> <span class="ow">in</span> <span class="n">this</span><span class="o">.</span><span class="n">contractsManager</span><span class="o">.</span><span class="n">contracts</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">var</span> <span class="n">abi</span> <span class="o">=</span> <span class="n">JSON</span><span class="o">.</span><span class="n">stringify</span><span class="p">(</span><span class="n">contract</span><span class="o">.</span><span class="n">abiDefinition</span><span class="p">);</span>

        <span class="k">return</span> <span class="n">className</span> <span class="o">+</span> <span class="s2">&quot; = &quot;</span> <span class="o">+</span> <span class="n">web3</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">contract</span><span class="p">(</span><span class="s2">&quot; + abi + &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="s1">&#39;&quot; + contract.deployedAddress + &quot;&#39;</span><span class="p">);</span><span class="s2">&quot;;</span>
      <span class="p">}</span>
    <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>embark.registerConsoleCommand(callback(options))</strong></p>
<p>This call is used to extend the console with custom commands.</p>
<p>expected return: <code class="docutils literal"><span class="pre">string</span></code> (output to print in console) or <code class="docutils literal"><span class="pre">boolean</span></code> (skip command if false)</p>
<div class="code javascript highlight-default"><div class="highlight"><pre><span></span><span class="n">module</span><span class="o">.</span><span class="n">exports</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">embark</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">embark</span><span class="o">.</span><span class="n">registerConsoleCommand</span><span class="p">(</span><span class="n">function</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">cmd</span> <span class="o">===</span> <span class="s2">&quot;hello&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s2">&quot;hello there!&quot;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="o">//</span> <span class="k">continue</span> <span class="n">to</span> <span class="n">embark</span> <span class="ow">or</span> <span class="nb">next</span> <span class="n">plugin</span><span class="p">;</span>
      <span class="k">return</span> <span class="n">false</span><span class="p">;</span>
    <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>embark.registerCompiler(extension, callback(contractFiles, doneCallback))</strong></p>
<p>expected doneCallback arguments: <code class="docutils literal"><span class="pre">err</span></code> and  <code class="docutils literal"><span class="pre">hash</span></code> of compiled contracts</p>
<blockquote>
<div><ul class="simple">
<li>Hash of objects containing the compiled contracts. (key: contractName, value: contract object)</li>
</ul>
<blockquote>
<div><ul class="simple">
<li>code - contract bytecode (string)</li>
<li>runtimeBytecode - contract runtimeBytecode (string)</li>
<li>gasEstimates - gas estimates for constructor and methods (hash)</li>
</ul>
<blockquote>
<div><ul class="simple">
<li>e.g <code class="docutils literal"><span class="pre">{&quot;creation&quot;:[20131,38200],&quot;external&quot;:{&quot;get()&quot;:269,&quot;set(uint256)&quot;:20163,&quot;storedData()&quot;:224},&quot;internal&quot;:{}}</span></code></li>
</ul>
</div></blockquote>
<ul class="simple">
<li>functionHashes - object with methods and their corresponding hash identifier (hash)</li>
</ul>
<blockquote>
<div><ul class="simple">
<li>e.g <code class="docutils literal"><span class="pre">{&quot;get()&quot;:&quot;6d4ce63c&quot;,&quot;set(uint256)&quot;:&quot;60fe47b1&quot;,&quot;storedData()&quot;:&quot;2a1afcd9&quot;}</span></code></li>
</ul>
</div></blockquote>
<ul class="simple">
<li>abiDefinition - contract abi (array of objects)</li>
</ul>
<blockquote>
<div><ul class="simple">
<li>e.g <code class="docutils literal"><span class="pre">[{&quot;constant&quot;:true,&quot;inputs&quot;:[],&quot;name&quot;:&quot;storedData&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;payable&quot;:false,&quot;type&quot;:&quot;function&quot;},</span> <span class="pre">etc...</span></code></li>
</ul>
</div></blockquote>
</div></blockquote>
</div></blockquote>
<p>below a possible implementation of a solcjs plugin:</p>
<div class="code javascript highlight-default"><div class="highlight"><pre><span></span><span class="n">var</span> <span class="n">solc</span> <span class="o">=</span> <span class="n">require</span><span class="p">(</span><span class="s1">&#39;solc&#39;</span><span class="p">);</span>

<span class="n">module</span><span class="o">.</span><span class="n">exports</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">embark</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">embark</span><span class="o">.</span><span class="n">registerCompiler</span><span class="p">(</span><span class="s2">&quot;.sol&quot;</span><span class="p">,</span> <span class="n">function</span><span class="p">(</span><span class="n">contractFiles</span><span class="p">,</span> <span class="n">cb</span><span class="p">)</span> <span class="p">{</span>
      <span class="o">//</span> <span class="n">prepare</span> <span class="nb">input</span> <span class="k">for</span> <span class="n">solc</span>
      <span class="n">var</span> <span class="nb">input</span> <span class="o">=</span> <span class="p">{};</span>
      <span class="k">for</span> <span class="p">(</span><span class="n">var</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">contractFiles</span><span class="o">.</span><span class="n">length</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">var</span> <span class="n">filename</span> <span class="o">=</span> <span class="n">contractFiles</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">filename</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;app/contracts/&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
        <span class="nb">input</span><span class="p">[</span><span class="n">filename</span><span class="p">]</span> <span class="o">=</span> <span class="n">contractFiles</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">toString</span><span class="p">();</span>
      <span class="p">}</span>

      <span class="o">//</span> <span class="nb">compile</span> <span class="n">files</span>
      <span class="n">var</span> <span class="n">output</span> <span class="o">=</span> <span class="n">solc</span><span class="o">.</span><span class="n">compile</span><span class="p">({</span><span class="n">sources</span><span class="p">:</span> <span class="nb">input</span><span class="p">},</span> <span class="mi">1</span><span class="p">);</span>

      <span class="o">//</span> <span class="n">generate</span> <span class="n">the</span> <span class="n">compileObject</span> <span class="n">expected</span> <span class="n">by</span> <span class="n">embark</span>
      <span class="n">var</span> <span class="n">json</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">contracts</span><span class="p">;</span>
      <span class="n">var</span> <span class="n">compiled_object</span> <span class="o">=</span> <span class="p">{};</span>
      <span class="k">for</span> <span class="p">(</span><span class="n">var</span> <span class="n">className</span> <span class="ow">in</span> <span class="n">json</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">var</span> <span class="n">contract</span> <span class="o">=</span> <span class="n">json</span><span class="p">[</span><span class="n">className</span><span class="p">];</span>

        <span class="n">compiled_object</span><span class="p">[</span><span class="n">className</span><span class="p">]</span> <span class="o">=</span> <span class="p">{};</span>
        <span class="n">compiled_object</span><span class="p">[</span><span class="n">className</span><span class="p">]</span><span class="o">.</span><span class="n">code</span>            <span class="o">=</span> <span class="n">contract</span><span class="o">.</span><span class="n">bytecode</span><span class="p">;</span>
        <span class="n">compiled_object</span><span class="p">[</span><span class="n">className</span><span class="p">]</span><span class="o">.</span><span class="n">runtimeBytecode</span> <span class="o">=</span> <span class="n">contract</span><span class="o">.</span><span class="n">runtimeBytecode</span><span class="p">;</span>
        <span class="n">compiled_object</span><span class="p">[</span><span class="n">className</span><span class="p">]</span><span class="o">.</span><span class="n">gasEstimates</span>    <span class="o">=</span> <span class="n">contract</span><span class="o">.</span><span class="n">gasEstimates</span><span class="p">;</span>
        <span class="n">compiled_object</span><span class="p">[</span><span class="n">className</span><span class="p">]</span><span class="o">.</span><span class="n">functionHashes</span>  <span class="o">=</span> <span class="n">contract</span><span class="o">.</span><span class="n">functionHashes</span><span class="p">;</span>
        <span class="n">compiled_object</span><span class="p">[</span><span class="n">className</span><span class="p">]</span><span class="o">.</span><span class="n">abiDefinition</span>   <span class="o">=</span> <span class="n">JSON</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">contract</span><span class="o">.</span><span class="n">interface</span><span class="p">);</span>
      <span class="p">}</span>

      <span class="n">cb</span><span class="p">(</span><span class="n">null</span><span class="p">,</span> <span class="n">compiled_object</span><span class="p">);</span>
    <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>embark.logger</strong></p>
<p>To print messages to the embark log is it better to use <code class="docutils literal"><span class="pre">embark.logger</span></code>
instead of <code class="docutils literal"><span class="pre">console</span></code>.</p>
<p>e.g <code class="docutils literal"><span class="pre">embark.logger.info(&quot;hello&quot;)</span></code></p>
<p><strong>embark.events.on(eventName, callback(*args))</strong></p>
<p>This call is used to listen and react to events that happen in Embark such as contract deployment</p>
<ul>
<li><p class="first">eventName - name of event to listen to
* available events:</p>
<blockquote>
<div><ul class="simple">
<li>&#8220;contractsDeployed&#8221; - triggered when contracts have been deployed</li>
<li>&#8220;file-add&#8221;, &#8220;file-change&#8221;, &#8220;file-remove&#8221;, &#8220;file-event&#8221; - triggered on
a file change, args is (filetype, path)</li>
<li>&#8220;abi&#8221;, &#8220;abi-vanila&#8221;, &#8220;abi-contracts-vanila&#8221; - triggered when contracts
have been deployed and returns the generated JS code</li>
<li>&#8220;outputDone&#8221; - triggered when dapp is (re)generated</li>
<li>&#8220;firstDeploymentDone&#8221; - triggered when the dapp is deployed and generated
for the first time</li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="code javascript highlight-default"><div class="highlight"><pre><span></span><span class="n">module</span><span class="o">.</span><span class="n">exports</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">embark</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">embark</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="s2">&quot;contractsDeployed&quot;</span><span class="p">,</span> <span class="n">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="n">embark</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;plugin says: your contracts have been deployed&quot;</span><span class="p">);</span>
    <span class="p">});</span>
    <span class="n">embark</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="s2">&quot;file-changed&quot;</span><span class="p">,</span> <span class="n">function</span><span class="p">(</span><span class="n">filetype</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">type</span> <span class="o">===</span> <span class="s1">&#39;contract&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">embark</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;plugin says: you just changed the contract at &quot;</span> <span class="o">+</span> <span class="n">path</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="using-embark-with-grunt.html" class="btn btn-neutral float-right" title="Using Embark with Grunt" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="deploying-to-swarm.html" class="btn btn-neutral" title="Deploying to SWARM" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Iuri Matias.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'2.4.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>